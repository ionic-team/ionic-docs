---
title: 'åˆ›å»ºç¯å¢ƒ'
previousText: 'åˆ›å»ºè‡ªåŠ¨åŒ–è„šæœ¬'
previousUrl: '/docs/appflow/quickstart/automation'
nextText: 'åˆ›å»ºæœ¬åœ°é…ç½®'
nextUrl: '/docs/appflow/quickstart/native-config'
---

<blockquote>
  <p><b>æ³¨æ„ï¼š</b> æ­¤åŠŸèƒ½ä»…åœ¨æˆ‘ä»¬ <a href="/pricing">å¢é•¿è®¡åˆ’</a> åŠä»¥ä¸Šç‰ˆæœ¬ä¸­å¯ç”¨ã€‚</p>
</blockquote>

[ç¯å¢ƒ](/docs/appflow/automation/environments) æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰æ‚¨ [è½¯ä»¶åŒ…æ„å»º](/docs/appflow/package/builds) å’Œ [éƒ¨ç½²ç‰ˆæœ¬](/docs/appflow/deploy/builds) çš„å¼ºå¤§æ–¹å¼ï¼Œä»¥ä¾¿æ ¹æ®æ„å»ºæ—¶é—´ä¼ é€’çš„ç¯å¢ƒå˜é‡ åˆ›å»ºä¸åŒçš„é…ç½®ã€‚ å½“ä¸ [è‡ªåŠ¨åŒ–](/docs/appflow/automation/intro) åŠŸèƒ½ç›¸ç»“åˆæ—¶ï¼Œå¼€å‘å›¢é˜Ÿå¯ä»¥ è½»æ¾é…ç½®å¼€å‘ï¼ŒæŒ‚èµ·ï¼Œ å¹¶åˆ¶ä½œæ„å»ºé…ç½®ï¼Œä½¿ä»–ä»¬èƒ½å¤Ÿæ‹¥æŠ±DevOps æœ€ä½³åšæ³•å¹¶æ¯”ä»¥å¾€ä»»ä½•æ—¶å€™éƒ½æ›´å¿«åœ°ä¼ é€æ›´é«˜è´¨é‡çš„æ›´æ–°ã€‚

## åˆ›å»ºç¯å¢ƒ

åˆ›é€ ä¸€ä¸ªç¯å¢ƒï¼Œ åªéœ€è½¬åˆ°Appflow é¢æ¿ä¾§è¾¹æ ä¸­çš„ `è‡ªåŠ¨ > ç¯å¢ƒ` é€‰é¡¹å¡ï¼Œç„¶å ç‚¹å‡»å³ä¸Šè§’çš„ `æ–°ç¯å¢ƒ` æŒ‰é’®ã€‚

![æ–°ç¯å¢ƒ](/docs/assets/img/appflow/ss-new-environment.png)

ç„¶åä½ ä¼šçœ‹åˆ°ä¸€ä¸ªè¡¨æ ¼ï¼Œå…è®¸ä½ åˆ›å»ºä¸¤ç§ç±»å‹çš„ç¯å¢ƒå˜é‡ï¼š

* **ç§˜å¯†** - è¿™äº›å€¼è¢«åŠ å¯†ï¼Œä»…åœ¨æ„å»ºæ—¶æ‰å¯ç”¨ã€‚ ä¸€æ—¦æ‚¨ä¿å­˜äº†ç§˜å¯†ï¼Œ *æ‚¨å°†æ— æ³•ç¼–è¾‘æˆ–å†æ¬¡æŸ¥çœ‹å®ƒ*ã€‚
* **å˜é‡** - è¿™äº›å€¼å¯åœ¨æ„å»ºæ—¶é—´ä½¿ç”¨ã€‚ å˜é‡æ˜¯å¯è§å’Œå¯ç¼–è¾‘çš„ã€‚

è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå«åšâ€œå‘å±•â€çš„æ–°ç¯å¢ƒã€‚ åœ¨è¿™ä¸ªç¯å¢ƒä¸­ï¼Œåˆ›å»ºä¸€ä¸ªåä¸º `BUILD_ENV` çš„å˜é‡ï¼Œå…¶å€¼ `å¼€å‘`ã€‚ æ­¤å˜é‡å°†ä½¿æˆ‘ä»¬èƒ½å¤Ÿè‡ªå®šä¹‰æˆ‘ä»¬çš„æ„å»ºé…ç½®æ–¹å¼ã€‚

![æ–°å»ºç¯å¢ƒè¡¨å•](/docs/assets/img/appflow/gif-new-environment.gif)

## å°†ç¯å¢ƒæ·»åŠ åˆ°è‡ªåŠ¨åŒ–

ä¸ºäº†å……åˆ†åˆ©ç”¨ä½ çš„å‘å±•ç¯å¢ƒè‡ªåŠ¨åŒ–ï¼Œä½ æƒ³è¦å°†ç¯å¢ƒæ·»åŠ åˆ°æˆ‘ä»¬æ—©äº›æ—¶å€™åˆ›å»ºçš„è‡ªåŠ¨åŒ– ä¸­ã€‚

åœ¨æ‚¨çš„` Automations `æ ‡ç­¾ä¸­ï¼Œç‚¹å‡»è‡ªåŠ¨åŒ–å³ä¾§çš„` Options `å›¾æ ‡ä¸­çš„` Edit `ï¼Œç„¶åä»` Environmentä¸­é€‰æ‹©ç¯å¢ƒ`ä¸‹æ‹‰èœå•ï¼Œç„¶åç‚¹å‡»`ä¿å­˜`ã€‚

![å°†ç¯å¢ƒæ·»åŠ åˆ°è‡ªåŠ¨åŒ–](/docs/assets/img/appflow/gif-add-environment.gif)

## ç¤ºä¾‹ï¼šè‡ªå®šä¹‰æ„å»ºè„šæœ¬

è®©å˜é‡è¿›å…¥ä½ çš„æ„å»ºæ˜¯ä¸€å›äº‹ï¼Œä½†ä½¿ç”¨å˜é‡è‡ªå®šä¹‰ä½ çš„æ„å»ºé…ç½® çš„æ–¹å¼åŒæ ·é‡è¦ã€‚

ä¸‹é¢æ˜¯ä¸€äº›ç¤ºä¾‹ï¼Œè¯´æ˜æ‚¨å¯ä»¥å¦‚ä½•ä½¿ç”¨ `BUILD_ENV` è‡ªå®šä¹‰æ‚¨çš„åº”ç”¨ï¼Œæˆ‘ä»¬åœ¨ä¸Šé¢åˆ›å»ºçš„å˜é‡å¯ä»¥è¿æ¥åˆ°ä¸€ä¸ªä¸åŒçš„ API URLï¼Œå½“ å¼€å‘æœ¬åœ°å¯¹åº”çš„æ—¶å€™ï¼Œè·å–æ‚¨åº”ç”¨çš„æ•°æ®ã€‚ ä½ çš„ `å¼€å‘` ç¯å¢ƒã€‚

<docs-tabs> <docs-tab tab="Ionic v4"> First, you can modify the `build` script in your `package.json` to either use the `BUILD_ENV` variable if it exists or to default it to `local` and then choose the configuration from the `angular.json` file that matches the value of `BUILD_ENV` (`development` in Appflow & `local` locally).

```json
...
"scripts":
...
  "build": "BUILD_ENV=${BUILD_ENV:-local} ng build--configuration=$BUILD_ENV"
...
}
...
```

ä¸‹é¢æ˜¯ä½ çš„ `angular.json` é…ç½®éƒ¨åˆ†å¯èƒ½æ˜¯ä»€ä¹ˆæ ·çš„ã€‚

```json
...
"configurations": {
  ... // other environment configurations
  "development": {
    "fileReplacements": [ // replace default environment.ts file with the environment.development.ts file
      {
        "replace": "src/environments/environment.ts",
        "with": "src/environments/environment.development.ts"
      }
    ],
  },
  "local": {}, // leave this blank to use the default src/environments/environment.ts file
  ...
}

```

è¿™é‡Œæ˜¯ `ç¯å¢ƒã€‚ts` and `environment.development.ts` æ–‡ä»¶å¯èƒ½æ˜¯å–œæ¬¢çš„ã€‚

```typescript
// src/environments/environments.development.ts
export const environment = volume
  apiUrl: 'https://api.development.com'
};

```

```typescript
// src/environments/environments.ts
export const environment = ~
  apiUrl: 'http://localhost:8000'
};

```

</docs-tab> <docs-tab tab="Ionic v3"> é¦–å…ˆï¼Œæ‚¨å¯ä»¥ä¿®æ”¹` package.json `ä¸­çš„` build `è„šæœ¬ï¼Œä»¥ä½¿ç”¨` BUILD_ENV `å˜é‡ï¼ˆå¦‚æœå­˜åœ¨ï¼‰æˆ–é»˜è®¤ä¸º` local `ã€‚

```json
...
"scripts": {
  ...
  "build": "BUILD_ENV=${BUILD_ENV:-local} ionic-app-scripts build"
  ...
}
...
```

Then you can use it directly in an `environments.ts` module to properly set the API url based on the value of `BUILD_ENV` (`development` in Appflow & `local` locally).

```typescript
let apiUrl: string;

switch (process.env.BUILD_ENV) {
  case 'development':
    apiUrl = 'https://api.development.com';
    break;
  case 'local':
    apiUrl = 'http://localhost:8000';
    break;
  default:
    console.warn(`Unknown environment ${process.env.BUILD_ENV} specified.`)
}

export const environment = {
  apiUrl: apiUrl
};

```

</docs-tab> </docs-tabs>

ç°åœ¨ï¼Œæ‚¨çš„åº”ç”¨å°†è‡ªåŠ¨ä½¿ç”¨ä¸åŒçš„ API æ¥è·å–æœ¬åœ°ä¸å¼€å‘ç‰ˆæœ¬ä¸­çš„æ•°æ®ï¼ ğŸ’ª